<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="author" content="Jakub Marchwicki"><title>Mikrousługi i wzorce architektury rozproszonej</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js/css/reveal.css" rel="stylesheet"><link rel="stylesheet" href="css/custom_serif.css" id="theme"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"><style>/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}</style><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet"><script>document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script></head><body><div class="reveal"><div class="slides"><section class="title"><h1>Mikrousługi i wzorce architektury rozproszonej</h1><p class="author"><small>Jakub Marchwicki</small></p></section><section><section id="slide_poznajmy_si" data-background-image="images/background.jpg" data-background-size="cover"><h2>Poznajmy się</h2></section><section id="slide_o_mnie"><h2>O mnie</h2><div class="ulist"><div class="title">Jakub Marchwicki</div><ul><li><p>programista od ponad 15 lat</p></li><li><p>po drodze: manager, dyrektor IT, architekt, konsultant</p></li><li><p>domeny: ubezpieczenia, bankowość, marketing, edukacja, rolnictwo</p></li><li><p>Twitter: @kubem</p></li><li><p><a href="mailto:jakub@marchwicki.pl">jakub@marchwicki.pl</a></p></li></ul></div></section></section>
<section><section id="slide_microservices_teoria" data-background-image="images/background.jpg" data-background-size="cover"><h2>Microservices - teoria</h2></section><section id="slide_microservices_are_the_new_black" data-background-image="images/microservice-everywhere.jpeg" data-background-size="contain"></section><section id="slide_monolithic_vs_micro"><h2>Monolithic vs Micro</h2><div class="imageblock" style=""><img src="https://developer.ibm.com/bluemix/wp-content/uploads/sites/20/2015/01/micro-service-architecture.png" alt="micro service architecture"></div></section><section id="slide_monolithic_vs_micro_2"><h2>Monolithic vs Micro</h2><div class="imageblock" style=""><img src="https://media.licdn.com/mpr/mpr/p/1/005/09f/13b/007ac2e.png" alt="007ac2e"></div></section><section id="slide_monolithic_vs_micro_3"><h2>Monolithic vs Micro</h2><div class="imageblock" style=""><img src="http://www.cms-connected.com/getmedia/2385efeb-4d88-47e3-8980-156497668bab/th-feature02-figure01.jpg" alt="th feature02 figure01" width="70%"></div></section><section id="slide_monolithic_vs_micro_4"><h2>Monolithic vs Micro</h2><div class="imageblock" style=""><img src="http://image.slidesharecdn.com/statelessauthenticationformicroservices-141211091054-conversion-gate02/95/stateless-authentication-for-microservices-12-638.jpg" alt="stateless authentication for microservices 12 638"></div></section><section id="slide_microservices"><h2>Microservices</h2><div class="quoteblock"><blockquote>Micro Service is an <strong>architectural concept</strong> that aims to decouple a solution by decomposing functionality into discrete services with communication over lightweight mechanisms, often an HTTP API</blockquote></div></section><section id="slide_czym_jest_mikroserwis"><h2>Czym jest mikroserwis?</h2><div class="ulist"><ul><li><p>Niewielki problem biznesowy</p></li><li><p>Niezależny, wdrażany niezależnie</p></li><li><p>Działa we własnym procesie</p></li><li><p>Jest właścicielem swoich danych</p><div class="ulist"><ul><li><p>Podstawy SOA i Integration Patterns</p></li></ul></div></li><li><p>Integruje się <em>explicite</em> z użyciem powszechnych interfejsów</p><div class="ulist"><ul><li><p>Nie jest statycznie linkowana (wywoływana w pamięci) jak biblioteki</p></li></ul></div></li></ul></div>
<div class="quoteblock"><blockquote>While HTTP isn’t always the best answer, it’s a damn fine first guess</blockquote><div class="attribution">&#8212; Coda Hale</div></div></section><section id="slide_technologia_vs_organizacja"><h2>Technologia vs organizacja</h2><div class="ulist"><ul><li><p>W większości firm zespoły organizowane są wokół aspektów technicznych (ang. <em>technical capabilities</em>)</p><div class="ulist"><ul><li><p>Zajmują się poszczególnymi warstwami aplikacji (<em>frontend</em>, <em>backend</em>, <em>wdrożenia</em>)</p></li><li><p>Warstwami organizacji projektu</p></li></ul></div></li><li><p><em>Shared teams</em>: zespół UI/UX, testerzy, backendowcy, frontendowcy</p></li><li><p>Podział organizacji implikuje procesy</p><div class="ulist"><ul><li><p>Proces wprowadzania zmiany, budżetowania, akceptacji</p></li><li><p>Aby tego uniknąć zespół wszystkie zmiany stara się wprowadzić w systemach do których ma dostęp</p></li></ul></div></li></ul></div></section><section id="slide_technologia_vs_organizacja_2"><h2>Technologia vs organizacja</h2><div class="imageblock" style=""><img src="http://martinfowler.com/articles/microservices/images/conways-law.png" alt="conways law"></div></section><section id="slide_conway_s_law"><h2>Conway&#8217;s Law</h2><div class="quoteblock"><blockquote>Any organization that designs a system (defined broadly) will produce a design whose structure is a copy of the organization&#8217;s communication structure.</blockquote><div class="attribution">&#8212; Melvyn Conway</div></div>
<div class="ulist"><ul><li><p>Strict communication &#8658; String contracts (SOAP)</p></li><li><p>Communication problems &#8658; Adapters + Anti-corruption layers</p></li></ul></div></section><section id="slide_conway_s_law_2"><h2>Conway&#8217;s Law (2)</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Conway’s Law … can be summarized as “Dysfunctional organizations tend to create dysfunctional applications.” To paraphrase Einstein, you can’t fix a problem from within the same mindset that created it, so it is often worth investigating whether restructuring your organization or team would prevent the new application from displaying all the same structural dysfunctions as the original. In what could be termed an “inverse Conway maneuver,” you may want to begin by breaking down silos that constrain the team’s ability to collaborate effectively.</p></div></blockquote><div class="attribution"><cite>ThoughtWorks</cite><br>&#8212; Jonny Leroy and Matt Simons</div></div></section><section id="slide_conway_s_law_3"><h2>Conway&#8217;s Law (3)</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>organization which radically change their system design should expect changes in communication structure</p></div></blockquote><div class="attribution">&#8212; Inverse Conway's Law</div></div></section><section id="slide_cross_functional"><h2>Cross-functional</h2><div class="imageblock" style=""><img src="http://martinfowler.com/articles/microservices/images/PreferFunctionalStaffOrganization.png" alt="PreferFunctionalStaffOrganization"></div></section><section id="slide_praca_projektowa"><h2>Praca projektowa</h2><div class="ulist"><ul><li><p>W świecie mikro usług szalenie ważna jest optyka <strong>produktowa</strong> nie <strong>projektowa</strong></p><div class="ulist"><ul><li><p>Projekt zakończył się z sukcesem, tzn. zakończył się o czasie, w budżecie i w założonym zakresie</p></li><li><p>Dla produktu może to nie mieć sensu</p></li><li><p>Dekompozycja produktu na projekty jest iluzoryczna</p></li></ul></div></li><li><p>Zamiast patrzeć na rozwiązanie jako listę funkcjonalności - patrzymy na wartości które usługa daje klientowi</p><div class="ulist"><ul><li><p><em>Features Shopping List</em></p></li><li><p>Zespół jest tego świadomy bo zarówno zbiera wymagania, jak i analizuje ruch produkcyjny</p></li></ul></div></li></ul></div></section><section id="slide_cross_functional_2"><h2>Cross-functional</h2><div class="ulist"><ul><li><p>Zespół podejmuje odpowiedzialność za dostarczenie całości rozwiązania</p><div class="ulist"><ul><li><p>Aspekt biznesowy</p></li><li><p>Interfejs użytkownika</p></li><li><p>Przechowywanie i retencja danych</p></li><li><p>Zewnętrzne integracja</p></li></ul></div></li><li><p>Zespół jest odpowiedzialny za projekt, implementacje, wdrożenie oraz za zarządzanie całością procesu</p><div class="ulist"><ul><li><p>Także za monitoring</p></li></ul></div></li><li><p><strong>Czy ktoś czuwa nad całością?</strong></p></li></ul></div></section><section id="slide_pryncypia_architektoniczne"><h2>Pryncypia architektoniczne</h2><div class="ulist"><ul><li><p>Reguły, zasady, wskazówki dotyczące architektury</p></li><li><p>Zasady stanowią pomosty łączące poszczególne wartości z rezultatami.</p><div class="ulist"><ul><li><p>Wartości (<em>prostota, elastyczność</em>) są uniwersalne, trudno jednak stosować je
bezpośrednio</p></li></ul></div></li></ul></div></section><section id="slide_pryncypia_architektoniczne_2"><h2>Pryncypia architektoniczne (2)</h2><div class="ulist"><ul><li><p>Application requests must be traceable with Shared Components</p></li><li><p>Breaking changes must be detected at design-time</p></li><li><p>Contract first development</p></li><li><p>Documentation for Shared Components API must be provided</p></li><li><p>Encrypt a communications channel for sensitive data</p></li><li><p>Internal services use rest/http (json) / external services should be SOAP compliant</p></li><li><p>Services (everything under UI) should be stateless</p></li><li><p>Services must be self-documenting</p></li></ul></div></section><section id="slide_przykad"><h2>Przykład</h2><div class="paragraph"><p><strong>Application requests must be traceable with Shared Components</strong></p></div>
<div class="paragraph"><div class="title">Rationale</div><p>A Reactive Application are in their essence Message driven, the calls are always asynchronous, so from the caller’s point of view, it makes the call, and then sometime later a result appears.
When the requestor creates a request message, it assigns the request a request ID—an identifier that is different from those for all othercurrently outstanding requests, that is, requests that do not yet have replies.
When the replier processes the request, it saves the request ID and adds that ID to the reply as a correlation ID.
When the requestor processes the reply, it uses the correlation ID to know which request the reply is for. This is called a Correlation Identifier because of the way the caller uses the identifier to correlate (i.e., match; show the relationship) each reply to the request that caused it.</p></div></section><section id="slide_przykad_2"><h2>Przykład</h2><div class="paragraph"><p><strong>Application requests must be traceable with Shared Components</strong></p></div>
<div class="olist arabic"><div class="title">Implications</div><ol class="arabic"><li><p>Correlation id should be an element of Shared Components API</p></li><li><p>User’s request flow</p></li><li><p>must be reproducible based on log files and the correlation id</p></li></ol></div></section><section id="slide_przykad_2_2"><h2>Przykład (2)</h2><div class="paragraph"><p><strong>Services must be self-documenting</strong></p></div>
<div class="paragraph"><div class="title">Rationale</div><p>When a service contract is explored, this service must be self-explanatory. The required documentation for the service should be minimal, and mainly serve to explain the semantics of the used query parameters and media-types)</p></div></section><section id="slide_przykad_2_3"><h2>Przykład (2)</h2><div class="paragraph"><p><strong>Services must be self-documenting</strong></p></div>
<div class="olist arabic"><div class="title">Implications</div><ol class="arabic"><li><p>If WS-* web service is used, WSDL will serve as the base for the documentation.</p></li><li><p>The REST services should use relations and links to show intent regarding how these services should be used.</p></li><li><p>For REST services a text document must be created and stored in the repository together with the REST service definition</p><div class="ulist"><ul><li><p>This document explains, in a human-readable manner, how the service is to be used.</p></li><li><p>Appropriate tooling should be used to provide comprehensive documentations in the least invasive way</p></li></ul></div></li></ol></div></section><section id="slide_czy_potrzebuje_do_tego_mikroserwisw"><h2>Czy potrzebuje do tego mikroserwisów?</h2><div class="ulist"><ul><li><p>Takie same wartości i podejście można stosować przy architekturach monolitycznych</p></li><li><p>Współodpowiedzialny, cross funkcjonalny zespół</p><div class="ulist"><ul><li><p>Trudniej jest to przeprowadzić dla dużej grupy ludzi</p></li><li><p>Projekt monolityczny obejmuje swoim zakres zbyt wiele domen aby było to pojmowalne przez pojedyncze osoby</p></li></ul></div></li><li><p>W mniejszych zespołach łatwiej zbudować komunikację i nieformalny przepływ informacji</p></li></ul></div></section></section>
<section><section id="slide_domain_driven_design" data-background-image="images/background.jpg" data-background-size="cover"><h2>Domain Driven Design</h2></section><section id="slide_spis_treci"><h2>Spis treści</h2><div class="ulist"><ul><li><p><strong>Po co Domain Driven Design?</strong></p></li><li><p>Strategiczny rozwój systemu (ang. <em>strategic design</em>)</p></li><li><p><em>Ubiquitous language</em> – komunikacja między programistami i ekspertami dziedzinowymi</p></li></ul></div></section><section id="slide_po_co_ddd"><h2>Po co DDD?</h2><div class="ulist"><ul><li><p>Dla większość projektów, najważniejsze jest zrozumienie funkcjonowania biznesu (domeny, logiki działań w obrębie domeny)</p></li><li><p>Działania i operacje w domenie powinny być oparte o dobrze zdefiniowany model</p></li></ul></div></section><section id="slide_domain_driven_design_2"><h2>Domain Driven Design</h2><div class="ulist"><ul><li><p><strong>DDD</strong> to sposób myślenia, według którego tworzona jest architektura systemu</p></li><li><p>Nacisk położony jest na:</p><div class="ulist"><ul><li><p>Dokładne zrozumienie domeny (dziedziny) biznesowej</p></li><li><p>Wykształcania jednoznacznego języka (słownika) (<em>unambiguous language</em>)</p></li><li><p>Wszechobecny (<em>ubiquitous</em>) język dziedzinowy, w którym porozumiewają się interesariusze i programiści</p></li><li><p>Odwzorowywanie w kodzie bytów i procesów biznesowych zarówno pod względem zachowania jak i zachowania</p></li></ul></div></li></ul></div></section><section id="slide_domain_driven_design_3"><h2>Domain Driven Design</h2><div class="ulist"><ul><li><p>DDD definiuje zestaw konceptów i procedur podstępowania, za pomocą których można modelować rzeczywistość</p></li><li><p>DDD nie dostarcza wzorców i architektur w technicznym znaczeniu tego słowa</p></li></ul></div></section><section id="slide_co_to_jest_domena"><h2>Co to jest domena</h2><div class="ulist"><ul><li><p>Domena to spójny podzbiór rzeczywistości biznesowej wraz obowiązującymi tam zasadami, któremu można przypisać nazwę oraz jednoznaczną odpowiedzialność</p><div class="ulist"><ul><li><p>Finanse, kontroling</p></li><li><p>Sterowanie ruchem sieciowym</p></li></ul></div></li><li><p>Domena wyłania się naturalnie, gdy trudno nam ogarnąć to, co robimy i trzeba spojrzeć na problem z szerszej perspektywy</p></li></ul></div></section><section id="slide_izolacja_domeny"><h2>Izolacja domeny</h2><div class="ulist"><ul><li><p>Domena przekłada się na spójną jednostkę oprogramowania</p></li><li><p>Współpracujące domeny powinny być od siebie odizolowane za pomocą interfejsów</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_domain_isolation.png" alt="DDD domain isolation"></div></section><section id="slide_kiedy_stosowa"><h2>Kiedy stosować?</h2><div class="ulist"><ul><li><p>Domena jest złożona (nie wszystkie domeny mają charakter obiektowy)</p></li><li><p>Zespół jest doświadczony w projektowaniu obiektowym</p></li><li><p>Eksperci domenowi są stale dostępni</p></li><li><p>Proces wytwarzania oprogramowania jest iteracyjny</p></li></ul></div></section><section id="slide_warstwy_ddd_1"><h2>Warstwy DDD (1)</h2><div class="ulist"><div class="title">Warstwa prezentacji</div><ul><li><p>Prezentowanie danych użytkownikowi</p></li><li><p>Odbieranie poleceń od użytkownika</p></li></ul></div>
<div class="ulist"><div class="title">Warstwa aplikacji</div><ul><li><p>Przekierowuje komendy użytkownika do Warstwy domeny</p></li><li><p>Nie wykonuje przetwarzania biznesowego</p></li></ul></div></section><section id="slide_warstwy_ddd_2"><h2>Warstwy DDD (2)</h2><div class="ulist"><div class="title">Warstwa domeny</div><ul><li><p>Implementuje przetwarzanie biznesowe</p></li></ul></div>
<div class="ulist"><div class="title">Warstwa infrastruktury</div><ul><li><p>Zawiera rozwiązania technologiczne takie jak: utrwalanie danych, szyny komunikacyjne itp.</p></li></ul></div></section><section id="slide_warstwy_ddd"><div class="imageblock" style=""><img src="images/DDD_Layers.png" alt="DDD Layers"></div></section><section id="slide_spis_treci_2"><h2>Spis treści</h2><div class="ulist"><ul><li><p>Po co Domain Driven Design?</p></li><li><p><strong>Strategiczny rozwój systemu (ang. <em>strategic design</em>)</strong></p></li><li><p><em>Ubiquitous language</em> – komunikacja między programistami i ekspertami dziedzinowymi</p></li></ul></div></section><section id="slide_proces_i_potencjalne_problemy"><h2>Proces i potencjalne problemy</h2><div class="ulist"><ul><li><p>System informatyzuje pewien zakres domeny</p></li><li><p>W modelu dziedziny pojawia się wiele obiektów powiązanych ze sobą różnymi relacjami i wchodzącymi w różne interakcje</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-problemy1.png" alt="DDD Bounded Context problemy1"></div></section><section id="slide_proces_i_potencjalne_problemy_2"><h2>Proces i potencjalne problemy</h2><div class="ulist"><ul><li><p>Głównym problemem, który stara się rozwiązać DDD, to szybka odpowiedź architektury systemu na zmieniające reguły biznesowe</p></li><li><p>Przy rozbudowanym modelu może być to trudne do osiągnięcia</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-problemy2.png" alt="DDD Bounded Context problemy2"></div></section><section id="slide_bounded_context"><h2>Bounded Context</h2><div class="imageblock" style=""><img src="images/DDD_Bounded_Context.png" alt="DDD Bounded Context"></div></section><section id="slide_bounded_context_2"><h2>Bounded Context</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Bounded contexts should have a name so that you can talk about them.</p></div></blockquote><div class="attribution">&#8212; Eric Evans</div></div></section><section id="slide_bounded_context_3"><h2>Bounded Context</h2><div class="paragraph"><p>Bounded Context nie oznacza enkapsulacji kodu lecz wyodrębnienie pewnego zagadnienia w płaszczyznach:</p></div>
<div class="ulist"><ul><li><p>Architektonicznej</p></li><li><p>Organizacyjnej</p></li><li><p>Słownikowej</p></li><li><p>Mentalnej</p></li></ul></div></section><section id="slide_relacje_midzy_kontekstami"><h2>Relacje między kontekstami</h2><div class="ulist"><ul><li><p>Wyodrębnienie kontekstów pozwala dostrzec relację między nimi</p></li><li><p>Poszczególne relacje dają wskazówki dotyczące organizacji pracy nad systemem</p></li><li><p>Rodzaje relacji</p><div class="ulist"><ul><li><p>Continuous Integration</p></li><li><p>Shared Kernel</p></li><li><p>Customer / Supplier</p></li><li><p>Conformist</p></li><li><p>Anti-corruption Layer</p></li><li><p>Separate Ways</p></li><li><p>Open Host Service</p></li></ul></div></li></ul></div></section><section id="slide_continuous_integration"><h2>Continuous Integration</h2><div class="ulist"><ul><li><p>Utrzymuj model i zespół w skupieniu</p></li><li><p>Kiedy stosować?</p><div class="ulist"><ul><li><p>Zespół jest mały (do pięciu osób) i dziedzina (system) nie są zbyt rozległe</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-CI.png" alt="DDD Bounded Context CI"></div></section><section id="slide_continuous_integration_2"><h2>Continuous Integration</h2><div class="ulist"><div class="title">Praktyki</div><ul><li><p>Posadź ludzi w jednym pomieszczeniu</p></li><li><p>Organizuj warsztaty projektowania</p></li><li><p>Upowszechniaj wspólny język</p></li><li><p>Dbaj, aby programiści mieli wiedzę domenową</p></li><li><p>Inicjuj spotkania programistów z ekspertami dziedzinowymi</p></li></ul></div></section><section id="slide_shared_kernel"><h2>Shared Kernel</h2><div class="ulist"><div class="title">Kiedy stosować</div><ul><li><p>Zespoły pracują nad niezależnymi elementami systemu, których część można ujednolicić</p></li></ul></div>
<div class="ulist"><div class="title">Przykłady shared kernel</div><ul><li><p>Konwersja układów współrzędnych</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-shared_kernel.png" alt="DDD Bounded Context shared kernel"></div></section><section id="slide_shared_kernel_2"><h2>Shared Kernel</h2><div class="paragraph"><p>Zmiana w jądrze wymaga zgody wszystkich współdzielących</p></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-shared_kernel2.png" alt="DDD Bounded Context shared kernel2"></div></section><section id="slide_customer_supplier"><h2>Customer / Supplier</h2><div class="ulist"><div class="title">Kiedy stosować?</div><ul><li><p>Między zespołami występuje relacja klient-dostawca</p></li><li><p>Zespoły podlegają jednemu menedżerowi</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-customer.png" alt="DDD Bounded Context customer"></div></section><section id="slide_customer_supplier_2"><h2>Customer / Supplier</h2><div class="ulist"><div class="title">Przykłady</div><ul><li><p>Dostawca</p><div class="ulist"><ul><li><p>Dostarcza usługi, zlecenia (np. <code>Zamówienia</code>)</p></li></ul></div></li><li><p>Klient</p><div class="ulist"><ul><li><p>Definiuje testy akceptacyjne, jest dostępny (np. <code>Hurtownia danych</code>)</p></li></ul></div></li></ul></div>
<div class="ulist"><div class="title">Praktyki</div><ul><li><p>Przeniesienie relacji klient-usługodawca na dwa zespoły programistyczne</p></li><li><p>Wspólne planowanie prac, definiowanie wymagań</p></li></ul></div></section><section id="slide_conformist"><h2>Conformist</h2><div class="ulist"><ul><li><p>Zespół <em>customer</em> całkowicie dopasowuje swoje działania do zespołu <em>supplier</em></p></li><li><p>Kiedy stosować?</p><div class="ulist"><ul><li><p>Zespoły są zarządzane przez menażerów mających różne cele</p></li><li><p>Zespoły są w innych lokacjach lub firmach</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-conformist.png" alt="DDD Bounded Context conformist"></div></section><section id="slide_conformist_2"><h2>Conformist</h2><div class="ulist"><div class="title">Potencjalne problemy</div><ul><li><p>Niedostępność zespołu <em>supplier</em></p></li><li><p>Brak udokumentowanego API usług tworzonych przez zespół <em>supplier</em></p></li><li><p>Zespół <em>customer</em> poświęca dużo czasu na poznawanie efektów prac zespołu <em>supplier</em></p></li></ul></div></section><section id="slide_anti_corruption_layer"><h2>Anti-corruption Layer</h2><div class="ulist"><ul><li><p>Model chroniony jest warstwą abstrakcji, która amortyzuje zewnętrzne zmiany</p></li><li><p>Kiedy stosować?</p><div class="ulist"><ul><li><p>Gdy nie ma żadnego wpływu na zespół <em>supplier</em></p></li><li><p>System korzysta z kodu legacy</p></li><li><p>System współpracuje z innymi systemami</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-anticorruption.png" alt="DDD Bounded Context anticorruption"></div></section><section id="slide_anti_corruption_layer_2"><h2>Anti-corruption Layer</h2><div class="ulist"><div class="title">Przykłady</div><ul><li><p>Wysokopoziomowe API na urządzenia sieciowe</p></li><li><p>Odizolowanie kodu napisanego w C od nowego kodu tworzonego w C++</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-anticorruption2.png" alt="DDD Bounded Context anticorruption2"></div></section><section id="slide_separate_ways"><h2>Separate Ways</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>To, że coś jest powiązane na poziomie przypadku użycia, nie oznacza, że musi być zintegrowane na poziomie architektury</p></div></blockquote><div class="attribution">&#8212; Eric Evans</div></div></section><section id="slide_separate_ways_2"><h2>Separate Ways</h2><div class="ulist"><div class="title">Kiedy stosować?</div><ul><li><p>Integracja, współpraca, koordynacja między zespołami jest zbyt uciążliwa</p></li><li><p>Obiekty z kontekstów nie współpracują ze sobą</p></li><li><p>Dane nie są wspólne dla wielu kontekstów</p></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-separate_ways.png" alt="DDD Bounded Context separate ways"></div></section><section id="slide_separate_ways_3"><h2>Separate Ways</h2><div class="ulist"><ul><li><p>Odseparowanie kontekstów oznacza również mentalne rozdzielnie zespołów</p></li><li><p>Zespoły</p><div class="ulist"><ul><li><p>Przestają mówić tym samym językiem</p></li><li><p>Nie spotykają się na wspólnych warsztatach</p></li><li><p>Aby się ze sobą porozumieć muszą zaczynać od pojęć na większym poziomie abstrakcji i ogólności</p></li></ul></div></li></ul></div></section><section id="slide_open_host_service"><h2>Open Host Service</h2><div class="ulist"><ul><li><p>Dobrze zdefiniowane usługi udostępniają funkcjonalności systemu zewnętrznym klientom</p></li><li><p>Kiedy stosować?</p><div class="ulist"><ul><li><p>System współpracuje z wieloma systemami</p></li><li><p>Utrzymywanie warstwy pośredniczącej jest zbyt kosztowne</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="images/DDD_Bounded_Context-open_host.png" alt="DDD Bounded Context open host"></div></section><section id="slide_spis_treci_3"><h2>Spis treści</h2><div class="ulist"><ul><li><p>Po co Domain Driven Design?</p></li><li><p>Strategiczny rozwój systemu (ang. <em>strategic design</em>)</p></li><li><p><strong><em>Ubiquitous language</em> – komunikacja między programistami i ekspertami dziedzinowymi</strong></p></li></ul></div></section><section id="slide_nim_zaczniemy_modelowa"><h2>Nim zaczniemy modelować</h2><div class="ulist"><ul><li><p>DDD adresuje problemy o złożonym modelu</p><div class="ulist"><ul><li><p>platforma do publikowania blogów ma relatywnie prosty model (posty, komentarze, autorzy, targi, itd.)</p></li></ul></div></li><li><p>DDD ma być platformą współpracy pomiędzy zespołem (którzy rozumieją <em>jak</em>) a ekspertami domenowymi (którzy rozumieją <em>dlaczego</em>)</p><div class="ulist"><ul><li><p>Księgowi, finansiści, ekonomiści, nauczyciele</p></li></ul></div></li><li><p>Jeżeli ekspert domenowy (osoba/osoby, które rozumieją domenę) posługują się innym żargonem niż zespół projektowy, to zachodzi potrzeba translacji (głuchy telefon)</p></li></ul></div></section><section id="slide_ubiquitous_language"><h2>Ubiquitous language</h2><div class="ulist"><ul><li><p>Wszędobylski język (albo wszechobecny język)</p><div class="ulist"><ul><li><p>nazywanie obiektów pojęciami domenowymi</p></li><li><p>nazywanie metod akcjami / czynnościami domenowymi</p></li><li><p>praca w kontekście domeny</p></li><li><p>rozróżnienie obiektów z tożsamością i bez (encje, struktury danych)</p></li></ul></div></li></ul></div></section><section id="slide_ubiquitous_language_2"><h2>Ubiquitous language</h2><div class="ulist"><ul><li><p>Nie musi być to UML - jeżeli nie przemawia on do Eksperta Domenowego</p></li><li><p>Dowolne symbole, wypracowana konwencja w obrębie zespołu - w tym Eksperta Domenowego</p></li><li><p>Szeregowi użytkownicy systemu myślą raczej historyjkami niż abstrakcyjnymi modelami</p><div class="ulist"><ul><li><p>aby Ekspert Domenowy znał i rozumiał szanse oraz ograniczenia jakie niesie technologia</p></li></ul></div></li><li><p>W projekcie powinien istnieć jeden, wspólny model domeny</p><div class="ulist"><ul><li><p>Bez rozróżnienia na różne poziomy abstrakcji (model analityczny, projektowy, developerski)</p></li></ul></div></li></ul></div></section><section id="slide_co_mwi_jzyk"><h2>Co mówi język?</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="java language-java"><span class="annotation">@DomainService</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">BookKeeper</span> {
    <span class="directive">public</span> Invoice issue(Order order, TaxPolicy taxPolicy) {
        <span class="comment">//...</span>
    }
}</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="java language-java"><span class="directive">public</span> <span class="type">void</span> addProduct(AggregateId orderId, AggregateId productId, <span class="type">int</span> quantity) {
        Reservation reservation = reservationRepository.load(orderId);
        Product product = productRepository.load(productId);

        <span class="keyword">if</span> (! product.isAvailabe()){
                Client client = loadClient();
                product = suggestionService.suggestEquivalent(product, client);
        }

        reservation.add(product, quantity);
        reservationRepository.save(reservation);
}</code></pre></div></div></section><section id="slide_co_mwi_jzyk_2"><h2>Co mówi język?</h2><div class="ulist"><div class="title">Co dokładnie mówi nam model:</div><ul><li><p>fakturę wystawiamy na podstawie całego zamówienia</p></li><li><p>nie ma możliwości wystawienia faktury na poszczególne pozycje</p></li><li><p>nie ma możliwości wystawienia faktury zbiorczej na kilka zamówień</p></li><li><p>możemy obliczać podatki dla dowolnego kraju, jest to domknięcie operacji issue, niezależne od adresu klienta na zamówieniu</p></li></ul></div></section><section id="slide_skutki_uboczne"><h2>Skutki uboczne</h2><div class="ulist"><div class="title">Jako że model jest dokładnie oddany w kodzie, system działa tak jak rozumie to Ekspert Domenowy</div><ul><li><p>Ekspert rozumienie złożoności i kosztu zmian</p></li><li><p>Cały zespół świadomie zaciąga dług techniczny i ogranicza punkty swobody modelu</p><div class="ulist"><ul><li><p>W powyższym przykładzie: nie możemy fakturować kilku zamówień ani poszczególnych pozycji</p></li></ul></div></li></ul></div></section><section id="slide_kiedy_brakuje_jzyka"><h2>Kiedy brakuje języka?</h2><div class="ulist"><ul><li><p>Typowym symptomem sugerującym konieczność pochylenia się nad modelem są problemy w komunikacji</p><div class="ulist"><ul><li><p>zespół developerski zaczyna używać pojęć niezrozumiałych dla Eksperta Domenowego, niemających uzasadnienia biznesowego <code>FakeOrder</code>, <code>TemporaryItem</code></p></li><li><p>model staje zbyt złożony i wymaga "hackowania" błędnych koncepcji</p></li><li><p>zaczynamy obserwować "brodzenie" - czyli wyraźne spowolnienie prac, mierzone np. poprzez Scrum Velocity</p></li><li><p>złożoność rozwiązania zdaje się być niewspółmiernie większa niż odczuwana intuicyjnie złożoność samego problemu (<em>Accidental vs Essential Complexity</em>)</p></li></ul></div></li></ul></div></section><section id="slide_proces_budowy_jzyka"><h2>Proces budowy języka</h2><div class="ulist"><ul><li><p>Wraz z Ekspertem Domenowym tworzone są historyjki (opisy sekwencji biznesowych)</p></li><li><p>Budowany jest model oraz definiowane są zmiany stanu modelu</p></li><li><p>Tworzone są zręby kodu (serwisów) poprzez nagłówki klas, nazwy metod (<em>walking skeleton</em>)</p></li><li><p>Tak opracowane scenariusze formalizujemy - tworzymy wykonywalną dokumentację</p><div class="ulist"><ul><li><p>Poprzez BDD (scenariusz akceptacyjne)</p></li><li><p>Struktura <code>Given</code> (Ekspert) - <code>When</code> (Programista) - <code>Then</code> (Ekspert)</p></li></ul></div></li></ul></div></section></section>
<section><section id="slide_microservices_zasady_i_praktyka" data-background-image="images/background.jpg" data-background-size="cover"><h2>Microservices - zasady i praktyka</h2></section><section id="slide_spis_treci_4"><h2>Spis treści</h2><div class="ulist"><ul><li><p><strong>Smart endpoints and dumb pipes</strong></p></li><li><p>Decentralizacja zarządzania</p></li><li><p>Decentralizacja danych</p></li><li><p>Automatyzacja infrastruktury</p></li><li><p>Czego nie uczą w szkołach? O czym należy pamiętać?</p></li></ul></div></section><section id="slide_smart_endpoints"><h2>Smart endpoints</h2><div class="ulist"><ul><li><p>Usługa jest właścicielem swoich danych</p></li><li><p>Implementuje specyficzną logikę</p></li><li><p>Działa na zasadie Unix&#8217;owych potoków (<em>pipes</em>)</p><div class="ulist"><ul><li><p>Przyjmuje żądania</p></li><li><p>Aplikuje logikę biznesową</p></li><li><p>Zwraca odpowiedź</p></li></ul></div></li></ul></div></section><section id="slide_dump_pipes"><h2>Dump pipes</h2><div class="ulist"><ul><li><p>Serwisy komunikują się ze sobą na zasadzie stron WWW</p><div class="ulist"><ul><li><p>HTTP request / response</p></li><li><p>Resource API (Hypermedia as the engine of application state)</p></li><li><p>Reverse DNS for service discovery</p></li></ul></div></li><li><p>Brak dodatkowej logiki na poziomie protokołu</p><div class="ulist"><ul><li><p>Jak WS-Choreography, BPEL albo centralna orchiestracja</p></li><li><p>Bez routingu, transformacji, reguł biznesowych</p></li></ul></div></li></ul></div>
<div class="quoteblock"><blockquote>Be of the web, not behind the web</blockquote><div class="attribution">&#8212; Martin Fowler</div></div></section><section id="slide_microservises_a_soa"><h2>Microservises a SOA</h2><div class="ulist"><ul><li><p>SOA ma wiele 'smaków'</p><div class="ulist"><ul><li><p>Usługi</p></li><li><p>Repozytoria</p></li><li><p>Service discovery</p></li><li><p>Kontrakty (WSDLs)</p></li></ul></div></li><li><p>Nie wszystkie są fatalne i zostały wypaczone przez lata, niektóre mają nadal zastosowanie w świecie µserviców</p></li></ul></div>
<div class="quoteblock"><blockquote>Microservices are SOA done right!</blockquote></div></section><section id="slide_wzorce_eip"><h2>Wzorce EIP</h2><div class="ulist"><ul><li><p>Enterprise Integration Patterns, to kolekcja wzorców opisujących typowe problemy i ich rozwiązania, z jakimi się spotykamy podczas integracji aplikacji</p></li><li><p>Opisane zostały w książce <a href="http://www.enterpriseintegrationpatterns.com/books1.html">"Enterprise Integration Patterns: Designing, Building, and Deploying Messaging Solutions"</a> autorstwa  Gregor Hohpe i Bobby Woolf</p></li><li><p>Opisane wzorce skupiają się na integracjach pomiędzy systemami w oparciu o asynchroniczne wiadomości i dzielą wzorce na kilka kategorii</p></li><li><p>Do naszej dyspozycji mamy jeszcze integracje oparte o:</p><div class="ulist"><ul><li><p>współdzieloną bazę danych</p></li><li><p>RPC (Remote Procedure Call)</p></li><li><p>transfer plików</p></li></ul></div></li></ul></div></section><section id="slide_wzorce_eip_2"><h2>Wzorce EIP (2)</h2><div class="ulist"><ul><li><p>Wzorce EIP - jak wszystkie inne wzorce projektowe - proponują rozwiązania konkretnych problemów</p></li><li><p>Wzorce są pewną architekturą która sprawdza się w konkretnych kontekście</p></li></ul></div>
<div class="ulist"><div class="title">Wzorce opisują</div><ul><li><p>kanały komunikacji, nośniki wiadomości</p><div class="ulist"><ul><li><p>point-to-point, publish-subscribe, guaranted delivery, dead letter</p></li></ul></div></li><li><p>techniki konstrukcji wiadomości</p><div class="ulist"><ul><li><p>command, request-reply (reply-to), correlation identifier</p></li></ul></div></li><li><p>techniki komunikacji z zewnętrznymi systemami</p><div class="ulist"><ul><li><p>messaging gateway, service activator</p></li></ul></div></li></ul></div></section><section id="slide_spis_treci_5"><h2>Spis treści</h2><div class="ulist"><ul><li><p>Smart endpoints and dumb pipes</p></li><li><p><strong>Decentralizacja zarządzania</strong></p></li><li><p>Decentralizacja danych</p></li><li><p>Automatyzacja infrastruktury</p></li><li><p>Czego nie uczą w szkołach? O czym należy pamiętać?</p></li></ul></div></section><section id="slide_zarzdzanie_architektur"><h2>Zarządzanie architekturą</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Lokalne decyzje to nie oznacza anarchii i dowolności we wszystkich możliwych elementach</p></div></div></div></section><section id="slide_architecture_principles"><h2>Architecture Principles</h2><div class="ulist"><div class="title">Przykładowy zestaw reguł dla procesów integracyjnych</div><ul><li><p>Szyna (defined broadly) nie może zawierać logiki aplikacyjnej</p></li><li><p>Proces komunikacji pomiędzy serwisami musi być spójny</p></li><li><p>Rozwój serwisów jest transparentny i dobrze zdefiniowany</p></li><li><p>Logi w obrębie systemu wykorzystywane są w celach statystycznych</p></li><li><p>SOAP do integracji z zewnętrznymi aplikacjami (contract-first), REST do integracji wewnętrznej</p></li></ul></div></section><section id="slide_principles_1"><h2>Principles (1)</h2><div class="ulist"><div class="title">Szyna (ESB) nie może zawierać logiki aplikacyjnej</div><ul><li><p>Aplikacja zbiera wszystkie dane potrzebne do procesu integracji i dostarcza je jako pojedyncza wiadomość do szyny</p></li><li><p>Szyna pozostaje bierna, szyna nie inicjuje wysyłania jakichkolwiek wiadomości</p></li><li><p>Szyna nie implementuje reguł biznesowych, co za tym idzie w żaden sposób nie weryfikuje treści (semantyki) przetwarzanych wiadomości</p></li><li><p>Aplikacja jest odpowiedzialna za weryfikację że wiadomość jest poprawna (składniowo - syntaktycznie, jak i treściowo - semantycznie)</p></li><li><p>Aplikacja jest odpowiedzialna za poprawne logowanie wysyłanych wiadomości (np. na wypadek ponownego przesłania danych)</p></li></ul></div></section><section id="slide_principles_2"><h2>Principles (2)</h2><div class="ulist"><div class="title">Proces komunikacji pomiędzy serwisami musi być spójny</div><ul><li><p>Najsłabsze ogniwo determinuje sposób komunikacji</p></li><li><p>Jeżeli proces wymaga przetwarzania w czasie rzeczywistym (<em>real-time</em>), cały łańcuch komunikacyjny musi wykorzystywać synchroniczne mechanizmy transportowe</p></li><li><p>Jeżeli proces wymaga "gwarancji dostarczenia wiadomości", cały łańcuch komunikacyjny musi wykorzystywać adekwatne mechanizmy transportowe</p></li></ul></div></section><section id="slide_principles_3"><h2>Principles (3)</h2><div class="ulist"><div class="title">Rozwój serwisów jest transparentny i dobrze zdefiniowany</div><ul><li><p>Obecne jak i wcześniejsze wersje serwisów muszą być wspierane. Starsze wersje mogą być usuwane w ustalonych okresach czasu (np. 6 miesięcy)</p></li><li><p>Szyna udostępnia osobne interfejsy dla poszczególnych wersji usługi, dzięki czemu nowy serwis pozostaje bez wpływu na poprzednie wersje.</p></li><li><p>Zmiany w istniejących serwisach nie może negatywnie wpływać na istniejących klientów</p></li></ul></div></section><section id="slide_principles_4"><h2>Principles (4)</h2><div class="ulist"><div class="title">Logi w obrębie systemu wykorzystywane są w celach statystycznych</div><ul><li><p>Logi gromadzone w obrębie szyny są meta informacjami, na bazie których wiadomości mogą być śledzone w obrębie procesów</p></li><li><p>W przypadku wystąpienia jakichkolwiek błędów w procesie, adekwatna reakcja jest odpowiedzialnością poszczególnych aplikacji</p></li></ul></div></section><section id="slide_principles_5"><h2>Principles (5)</h2><div class="ulist"><div class="title">SOAP do integracji z zewnętrznymi aplikacjami (contract-first)</div><ul><li><p>Komunikacja z zewnętrznymi partnerami (<em>vendorami</em>) wymaga ściśle określonego kontraktu</p></li><li><p>Nie mamy wpływu na to w jaki sposób zewnętrzne zespoły realizują (implementują, konsumują) serwisy</p></li><li><p>Specyfikacje SOAP / WSDL / XSD umożliwiają adekwatne opisanie serwisu udostępnianego (konsumowanego) przez organizację</p><div class="ulist"><ul><li><p>Ograniczone są w ten sposób potencjalne błędy semantyczne i syntaktyczne w komunikacji pomiędzy różnymi partnerami</p></li></ul></div></li></ul></div></section><section id="slide_principles_6"><h2>Principles (6)</h2><div class="ulist"><div class="title">REST do integracji wewnętrznej</div><ul><li><p>Do komunikacji wewnątrz aplikacji (organizacji) wystarczające jest podejście RESTful</p><div class="ulist"><ul><li><p>Unikamy nadmiarowego i skomplikowane standardu SOAP do serwisów które mają był łatwe do używania i tworzenia; które działają pomiędzy różnymi elementami wewnątrz systemu</p></li><li><p>Dla serwisów RESTowych oczekiwane jest wykorzystanie HATEOAS ("Hypermedia as the engine of application state") - ułatwiających stworzenie dobrego systemu wersjonowania usług, definicji przesyłanych struktur danych oraz powiązań pomiędzy zasobami.</p></li></ul></div></li></ul></div></section><section id="slide_implementation_principles"><h2>Implementation principles</h2><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Pryncypia architektoniczne nabierają jeszcze większego znaczenia - inaczej każdy serwis będzie inny</p></div></div></div>
<div class="ulist"><ul><li><p>GIT for source control</p></li><li><p>JVM languages unless</p></li><li><p>MongoDB for non-relational storage</p></li><li><p>MySQL for relational storage</p></li><li><p>Services must follow a specific versioning scheme</p></li></ul></div></section><section id="slide_example_principle"><h2>Example principle</h2><div class="paragraph"><p>Services must follow a specific versioning scheme</p></div>
<div class="paragraph"><div class="title">Rationale</div><p>There are breaking and non-breaking changes when new functionality is added to a service. Each REST service should follow a specific versioning scheme, to make sure consumers know when they need to upgrade and what the effect on consumer code is.</p></div>
<div class="olist arabic"><div class="title">Implications</div><ol class="arabic"><li><p>WSDLs and schemas must be set up in such a way that they can be easily versioned. This means that we have to make sure the namespaces used reflect the correct version of a service or message.</p></li><li><p>REST services will also have to be versioned. This means that in their content-type description a version number must be present.</p></li></ol></div></section><section id="slide_consumer_driven_contracts"><h2>Consumer driven contracts</h2><div class="ulist"><ul><li><p>Jako że niczego nie możemy być pewni - problemy trzeba znajdywać wcześniej niż na produkcji</p></li><li><p><em>Consumer</em> zawiera oczekiwania wobec <em>providera</em> w formie kontaktu</p><div class="ulist"><ul><li><p>Kontrakt jest oddzielnym dokumentem, oddzielnie wersjonowanym</p></li></ul></div></li><li><p>Kontrakty są współdzielone z <em>providerem</em></p><div class="ulist"><ul><li><p>Daje to wgląd dostawcy jakie są oczekiwania wobec niego</p></li><li><p><em>Provider</em> może automatycznie testować czy wprowadzane zmiany nie naruszają kontraktów</p></li></ul></div></li><li><p><em>Consumer</em> może weryfikować niezmienność kontraktu na wcześniejszych etapach</p></li></ul></div></section><section id="slide_spis_treci_6"><h2>Spis treści</h2><div class="ulist"><ul><li><p>Smart endpoints and dumb pipes</p></li><li><p>Decentralizacja zarządzania</p></li><li><p><strong>Decentralizacja danych</strong></p></li><li><p>Automatyzacja infrastruktury</p></li><li><p>Czego nie uczą w szkołach? O czym należy pamiętać?</p></li></ul></div></section><section id="slide_decentralizacja_danych"><h2>Decentralizacja danych</h2><div class="ulist"><ul><li><p>Te same koncepcją mają różne znaczenie w rożnych obszarach</p><div class="ulist"><ul><li><p>To pewna oczywistość dla praktyków DDD</p></li><li><p>Jeżeli chcesz się pozbyć architekta na kilka lat poproś go o kanoniczne zdefiniowanie klienta dla np. ubezpieczeń</p></li></ul></div></li><li><p>Każda usługa jest właścicielem własnych danych: zarówno struktury jak i sposobów fizycznego przechowywania danych</p><div class="ulist"><ul><li><p>Wybór silnika danych (sposobu persystencji) w zależności od potrzeb projektowych</p></li><li><p>Bazy relacyjne, dokumentowe, multi-tenance, grafowe</p></li></ul></div></li><li><p>Każdy wybór (decyzja) musi być bezwzględnie udokumentowana</p><div class="ulist"><ul><li><p>Aby uniknąć sytuacji: użyliśmy Neo4j bo to fajny wpis w CV</p></li></ul></div></li></ul></div></section><section id="slide_decentralizacja_danych_2"><h2>Decentralizacja danych</h2><div class="imageblock" style=""><img src="http://martinfowler.com/articles/microservices/images/decentralised-data.png" alt="decentralised data"></div></section><section id="slide_a_diagram_of_two_microservices_and_their_shared_database" data-background-image="https://pbs.twimg.com/media/Cd6UYMOWoAAgVUp.jpg:large" data-background-size="cover"><h2>A diagram of two microservices and their shared database</h2></section><section id="slide_konsekwencje"><h2>Konsekwencje</h2><div class="ulist"><ul><li><p>Lack of data consistency</p><div class="ulist"><ul><li><p>Nie ma możliwości przeprowadzenia spójnej aktualizacji po kilku bazach danych</p></li><li><p>Nie istnieje <em>two-phase commit</em></p></li></ul></div></li><li><p>Eventual consistency</p><div class="ulist"><ul><li><p>Jak zarządzać potencjalnym brakiem spójności danych</p></li><li><p>Reguły biznesowe dla błędów i pomyłek (jak w liniach lotnicznych)</p></li><li><p>Koszt poprawek jest z reguły niższy niż implementacja spójne systemu</p></li><li><p>Problemem są systemy księgowe i finansowe</p></li></ul></div></li></ul></div></section><section id="slide_spis_treci_7"><h2>Spis treści</h2><div class="ulist"><ul><li><p>Smart endpoints and dumb pipes</p></li><li><p>Decentralizacja zarządzania</p></li><li><p>Decentralizacja danych</p></li><li><p><strong>Automatyzacja infrastruktury</strong></p></li><li><p>Czego nie uczą w szkołach? O czym należy pamiętać?</p></li></ul></div></section><section id="slide_build_pipeline"><h2>Build pipeline</h2><div class="imageblock" style=""><img src="http://martinfowler.com/articles/microservices/images/basic-pipeline.png" alt="basic pipeline"></div>
<div class="ulist"><ul><li><p>W jaki sposób zapewnić aby każdy z powyższych testów był przeprowadzany na środowisku odzwierciedlającym produkcję?</p></li><li><p>Jak to wykonać w "klasycznym środowisku"</p><div class="ulist"><ul><li><p>People per server ratio; avarage IT: 1 per 200 - 500 machines</p></li><li><p>Facebook: 1 per <strong>25000</strong> - <a href="https://hbr.org/2015/06/an-inside-look-at-facebooks-approach-to-automation-and-human-work">Source</a></p></li></ul></div></li></ul></div></section><section id="slide_devops_approach"><h2>DevOps approach</h2><div class="ulist"><div class="title">Problemy</div><ul><li><p>time gap - wdrażaj rzadko (co pół roku)</p><div class="ulist"><ul><li><p>Jako że lepiej trudne rzeczy robić rzadko</p></li></ul></div></li><li><p>personal gap - różni ludzie robią różne rzeczy</p></li><li><p>tools gap - diametralnie inne stosy technologiczne pomiędzy dev i ops (Nginx, SQLite, and OS X / Apache, MySQL, and Linux)</p></li></ul></div>
<div class="ulist"><div class="title">Zasady</div><ul><li><p><strong>Jenkins</strong> do wszystkiego</p></li><li><p>Nigdy nie patrz wstecz - wdrożenia tylko w przód</p></li><li><p>Nie tykamy serwerów - <em>no ssh</em></p></li></ul></div></section><section id="slide_devops_approach_2"><h2>DevOps approach</h2><div class="ulist"><ul><li><p><a href="http://docker.io/">Docker</a></p></li><li><p><a href="https://www.vagrantup.com/">Vagrant</a></p></li><li><p><a href="https://puppetlabs.com/">Puppet</a> or <a href="https://www.chef.io/">Chef</a> or <a href="http://www.ansible.com/">Ansible</a></p><div class="ulist"><ul><li><p>with <a href="https://www.packer.io/">Packer.io</a></p></li></ul></div></li><li><p>Dev/prod parity - development, staging, production - tak zbliżone jak to możliwe</p></li><li><p>Enviroment from template - generuj obrazy dla różnych platform w tym samym momencie</p></li></ul></div></section><section id="slide_spis_treci_8"><h2>Spis treści</h2><div class="ulist"><ul><li><p>Smart endpoints and dumb pipes</p></li><li><p>Decentralizacja zarządzania</p></li><li><p>Decentralizacja danych</p></li><li><p>Automatyzacja infrastruktury</p></li><li><p><strong>Czego nie uczą w szkołach? O czym należy pamiętać?</strong></p></li></ul></div></section><section id="slide_problemy_z_monolitem"><h2>Problemy z monolitem</h2><div class="ulist"><ul><li><p>Trudne w rozwoju i utrzymaniu (<em>long term technology stack commitment</em>)</p><div class="ulist"><ul><li><p>Nawet jeżeli podzielone na warstwy - wciąż występują wewnętrzne, niewidoczne sprzęgnięcia</p></li><li><p>Nowe sprzęgnięcia pojawiają się bardzo łatwo, w sposób niekontrolowany</p></li><li><p>Pojedynczy proces (w systemie) umożliwia odwołania poza "kontraktem"</p></li></ul></div></li><li><p>Trudne w testowaniu i wdrażaniu (wiele zależności, <em>atomic releases and rollbacks</em>)</p></li><li><p>Trudny w skalowaniu (trzeba skalować całość podczas gdy od jednej usługi oczekiwana jest lepsza wydajność)</p></li><li><p>FUD: jeżeli działa - nie dotykać, nie naprawiać</p></li><li><p>Ładne diagramy rzadko kiedy przekładają się na ładny kod</p></li></ul></div></section><section id="slide_problemy_z_monolitem_refaktoryzacja"><h2>Problemy z monolitem - refaktoryzacja</h2><div class="ulist"><div class="title">micro-based approach</div><ul><li><p>If it works don&#8217;t fix it - as if you meant it</p></li><li><p>New features == new services. Architecture evolution</p></li></ul></div>
<div class="ulist"><div class="title">micro-based tools</div><ul><li><p>Build and deployment automation</p></li><li><p>External configuration (configuration server)</p></li><li><p>Circuit breakings (retry policies, timeouts, default values)</p></li><li><p>Centralized logs and monitoring</p></li><li><p>Consumer Driven Contracts</p></li><li><p>Events (CQRS approach)</p></li></ul></div></section><section id="slide_problemy_z_mikroserwisami"><h2>Problemy z mikroserwisami</h2><div class="ulist"><ul><li><p>Równie trudno (jak w monolicie) ogarnąć całość rozwiązania</p><div class="ulist"><ul><li><p>Ale całość nie jest konieczna to rozwijania tylko części aplikacji</p></li></ul></div></li><li><p>Nowy model działalności (np. DevOps)</p></li><li><p>Nowy sposób lokalizowania problemów</p><div class="ulist"><ul><li><p>Diagnoza <strong>gdzie</strong> problem wystąpił</p></li><li><p>W następnej kolejności analiza <strong>dlaczego</strong> i <strong>jak</strong> naprawiać</p></li></ul></div></li><li><p>Potencjalne problemy wydajnościowe (latency)</p></li></ul></div></section><section id="slide_czy_warto"><h2>Czy warto?</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-center valign-top">Plusy</th><th class="tableblock halign-left valign-top">Minusy</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Każda jednostka jest maksymalnie prosta</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Bardzo dużo autonomicznych jednostek</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Niezależne charakterystyki skalowania i wydajności</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Network latencies</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Niezależność testowania i wdrożenia</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Brak transakcji</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Selektywny tuning wydajności (cache, replikacja danych)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Cross-cutting concerns i trudny refaktoring</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">&#8203;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Wymaga bardziej skomplikowanych narzędzi i zarządzania zależnościami</p></td></tr></tbody></table></section><section id="slide_jak_dekomponowa_mikroserwisy"><h2>Jak dekomponować mikroserwisy?</h2><div class="ulist"><ul><li><p>Jak duża powinna być mikro usługa</p></li><li><p><strong>Should do one thing, should do it well and should do it only</strong></p><div class="ulist"><ul><li><p>Miara ilościowa: 1000 LoC</p></li><li><p>Miara jakościowa: Single Responsibility Principle (<em>small enough and no smaller</em>)</p></li><li><p>Miara jakościowa: bounds a single contex</p></li></ul></div></li></ul></div></section><section id="slide_jak_integrowa_mikroserwisy"><h2>Jak integrować mikroserwisy?</h2><div class="ulist"><ul><li><p>Izolowanie błędów - <em>bulkheading</em></p></li><li><p>Niezależnść usług - serwis "obiecuje" działać w zakresie zdefiniowanym przez kontrakt / API</p></li><li><p>Nie współdzielenie stanu</p></li><li><p>Asynchroniczna komunikacja oparta o zdarzenia</p></li><li><p><em>Location transparency</em></p></li></ul></div></section><section id="slide_nie_trzeba_bra_wszystkiego"><h2>Nie trzeba "brać wszystkiego"</h2><div class="ulist"><ul><li><p>Microserwisy to nie jest <em>take it or leave it</em></p></li><li><p>Możemy stosować niektóre koncepcje, dopasowując je do naszego środowiska</p><div class="ulist"><ul><li><p>Wykorzystanie zasad mikro usług do pracy z legacy</p></li><li><p>Koncepcja mikro usług i niezależnych komponentów przy frontend components</p></li><li><p><em>Consumer-driven contracts</em> pomiędzy elementami interfejsu</p></li></ul></div></li></ul></div></section><section id="slide_prawie_serwis"><h2>Prawie µserwis</h2><div class="ulist"><ul><li><p>Każdy serwis w niezależnym procesie.</p><div class="ulist"><ul><li><p>Jeżeli potrzeba, a może w osobnym classloaderze</p></li></ul></div></li><li><p>Wdrażane niezależnie</p><div class="ulist"><ul><li><p>Ale monolit jest łatwiej przenieść na produkcję</p></li><li><p>Obrazy Docker&#8217;a to przecież monolity</p></li></ul></div></li><li><p>Komunikacja po HTTP</p><div class="ulist"><ul><li><p>A może kolejki? EventBus? Pub / publish-subscribe</p></li></ul></div></li></ul></div></section><section id="slide_co_pomidzy"><h2>Coś pomiędzy?</h2><div class="dlist"><dl><dt class="hdlist1">Self-Contained Systems (SCS)</dt><dd><div class="ulist"><ul><li><p>Modelowanie serwisów wokół Sagi (z <em>DDD</em>) - <em>long standing transactions</em></p></li><li><p>SCS jest kompletną i autonomiczną aplikacją webową (full stack): domena, dane i procesy (logika) do przetwarzania danych</p></li><li><p>Komunikacja z innymi serwisami jest asynchroniczna</p></li><li><p>SCS nie współdzieli kodu z innymi systemami (<em>duplication over coupling</em>)</p></li><li><p>Analogiczne praktyki jak w obszarze mikrousług:</p><div class="ulist"><ul><li><p>Lokalna decyzyjność</p></li><li><p>Izolacja</p></li><li><p>Skalowalność i zastępowalność (<em>replaceability</em>)</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_wzorce_przykady_rozwizania"><h2>Wzorce, przykłady rozwiązania?</h2><div class="ulist"><ul><li><p>Failure isolation - <em>bulkheading</em></p></li><li><p>Autonomous services - service promises its own behaviour by publishing
its protocol/API</p></li><li><p>Single responsibility - encapsulate a single concept</p></li><li><p>State ownership</p></li><li><p>Asynchronous, message based communication</p></li><li><p>Location transparency</p></li></ul></div></section></section>
<section><section id="slide_restafarianizm" data-background-image="images/background.jpg" data-background-size="cover"><h2>RESTafarianizm</h2></section><section id="slide_orientacja_na_zasoby"><h2>Orientacja na zasoby</h2><div class="ulist"><ul><li><p>Podejście REST (Representational State Transfer) - rok 2000</p><div class="ulist"><ul><li><p>tradycyjne techniki i metody HTTP (GET, POST, PUT, DELETE) są w zupełności wystarczające</p></li><li><p>lekkie podejście nie wymagające specjalnych implementacji po stronie klienta</p></li><li><p>unikalny URL reprezentuje komponent usług sieciowych a nie konkretną usługę</p></li><li><p>bezpośrednia dostępność usług ułatwia ich integrację</p></li></ul></div></li></ul></div></section><section id="slide_rest"><h2>REST </h2><div class="dlist"><dl><dt class="hdlist1">Bazując na protokole HTTP, REST zakłada</dt><dd><div class="ulist"><ul><li><p>Komunikację klient - serwer</p><div class="ulist"><ul><li><p>SOAP można było wykorzystywać także przy innych protokołach komunikacyjnych</p></li></ul></div></li><li><p>Brak stanu (bezstanwość) serwera</p></li><li><p>Cache</p></li><li><p>Jednolity interfejs</p><div class="ulist"><ul><li><p>Jednoznaczna identyfikacja zasobu (poprzez URI)</p></li><li><p>Manipulacja zasobami poprzez ich reprezentację</p></li><li><p>Samoopisujące się wiadomości</p></li></ul></div></li></ul></div></dd></dl></div></section><section id="slide_rest_2"><h2>REST (2)</h2><div class="ulist"><ul><li><p>Komunikacja następuje w oparciu o metody HTTP</p><div class="ulist"><ul><li><p>GET, POST, PUT, DELETE</p></li></ul></div></li><li><p>Informacja zwrotna to status HTTP</p><div class="ulist"><ul><li><p>200 OK, 201 Created, 204 No Content, 400 Bad Request, 404 Not Found</p></li></ul></div></li><li><p>Dodatkowe (meta) informacje poprzez nagłówki</p><div class="ulist"><ul><li><p>Accept: application/json; charset=utf-8</p></li><li><p>Accept-encoding: gzip</p></li><li><p>Content-type: application/json; charset=utf-8</p></li></ul></div></li></ul></div></section><section id="slide_rest_3"><h2>REST (3)</h2><div class="ulist"><div class="title">Zasady RESTa mogą prowadzić do ograniczeń</div><ul><li><p>Podział klient-serwer</p></li><li><p>Bezstanowość serwera</p></li><li><p>Cache</p></li><li><p>Jednolity interfejs</p><div class="ulist"><ul><li><p>Identyfikacja zasobów</p></li><li><p>Manipulacja zasobami przez reprezentacje</p></li><li><p>Samoopisujące się wiadomości</p></li><li><p>HATEOAS</p></li></ul></div></li><li><p>Podział na warstwy</p></li></ul></div></section><section id="slide_rest_4"><h2>REST (4)</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:66.6667%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Data Element</th><th class="tableblock halign-left valign-top">Modern Web Examples</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">resource</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">the intended conceptual target of a hypertext reference</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">resource identifier</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">URL, URN</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">representation</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">HTML document, JPEG image</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">representation metadata</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">media type, last-modified time</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">resource metadata</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">source link, alternates, vary</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">control data</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">if-modified-since, cache-control</p></td></tr></tbody></table></section><section id="slide_integracja_systemw_to_take_api"><h2>Integracja systemów to także API</h2><div class="dlist"><dl><dt class="hdlist1">Zasady projektowania API nadal pozostają "w cenie"</dt><dd><div class="ulist"><ul><li><p>Klientami twojego API są programiści</p></li><li><p>Pomimo tego że API działa z wykorzystaniem HTTP - nadal musi być czytelne</p><div class="ulist"><ul><li><p>zwłaszcza w wypadku błędów</p></li></ul></div></li><li><p>Wykorzystuj standardy</p></li><li><p>Zachowuj kompatybilność wsteczną i zaplanuj długie cykle życia wersji</p></li><li><p>Planuj strukturę reprezentacji zasobów</p></li></ul></div></dd></dl></div></section><section id="slide_richardson_maturity_model"><h2>Richardson Maturity Model</h2><div class="ulist"><ul><li><p>Model dojrzałości API webowego</p><div class="ulist"><ul><li><p>Na podstawie analizy istniejących interfejsów</p></li><li><p>Wykonany przez Leonard Richardson w 2008 roku</p></li></ul></div></li><li><p>Definiuje 4 poziomy dojrzałości</p></li><li><p><strong>Level 0</strong> - pojedynczy URL, jedna metoda HTTP</p><div class="ulist"><ul><li><p>Głównie serwisy SOAP XML (jak strona we Flashu)</p></li></ul></div></li><li><p><strong>Level 1</strong> - wiele adresów URL - wszystkie wykorzystujące jedną metodę HTTP</p></li><li><p><strong>Level 2</strong> - wiele adresów URL wykorzystujących metody HTTP</p></li><li><p><strong>Level 3</strong> - zasoby deklarują zależności i połączenia (linki)</p></li></ul></div></section><section id="slide_level_0"><h2>Level 0</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-e114b.png" alt="rest integration e114b"></div></section><section id="slide_level_0_request"><h2>Level 0 - request</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="txt language-txt">POST /auctionServiceAPIEndpoint HTTP/1.1</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;query&gt;</span>
  <span class="tag">&lt;params&gt;</span>
    <span class="tag">&lt;name&gt;</span>Macbook Air<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;price_from&gt;</span>0<span class="tag">&lt;/price_from&gt;</span>
    <span class="tag">&lt;price_to&gt;</span>1000<span class="tag">&lt;/price_to&gt;</span>
  <span class="tag">&lt;/params&gt;</span>
<span class="tag">&lt;/query&gt;</span></code></pre></div></div></section><section id="slide_level_0_response"><h2>Level 0 - response</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="txt language-txt">HTTP/1.1 200 OK</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;items&gt;</span>
  <span class="tag">&lt;item&gt;</span>
    <span class="tag">&lt;id&gt;</span>123<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;name&gt;</span>Macbook Air<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;price&gt;</span>499<span class="tag">&lt;/price&gt;</span>
    <span class="tag">&lt;condition&gt;</span>NEW<span class="tag">&lt;/condition&gt;</span>
  <span class="tag">&lt;/item&gt;</span>
<span class="tag">&lt;/items&gt;</span></code></pre></div></div></section><section id="slide_level_0_request_2"><h2>Level 0 - request</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>POST /appointmentService HTTP/1.1</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;appointmentRequest&gt;</span>
  <span class="tag">&lt;slot</span> <span class="attribute-name">doctor</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">mjones</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">start</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1400</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">end</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1450</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;patient</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">jsmith</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/appointmentRequest&gt;</span></code></pre></div></div></section><section id="slide_level_0_request_3"><h2>Level 0 - request</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>POST http://svcs.ebay.com/services/search/FindingService/v1</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;findItemsByKeywordsRequest</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.ebay.com/marketplace/search/v1/services</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;affiliate&gt;</span>
    <span class="tag">&lt;networkId&gt;</span>9<span class="tag">&lt;/networkId&gt;</span>
    <span class="tag">&lt;trackingId&gt;</span>1234567890<span class="tag">&lt;/trackingId&gt;</span>
    <span class="tag">&lt;customId&gt;</span>k-man<span class="tag">&lt;/customId&gt;</span>
  <span class="tag">&lt;/affiliate&gt;</span>
  <span class="tag">&lt;sortOrder&gt;</span>EndTime<span class="tag">&lt;/sortOrder&gt;</span>
  <span class="tag">&lt;paginationInput&gt;</span>
    <span class="tag">&lt;entriesPerPage&gt;</span>2<span class="tag">&lt;/entriesPerPage&gt;</span>
  <span class="tag">&lt;/paginationInput&gt;</span>
  <span class="tag">&lt;keywords&gt;</span>camalots<span class="tag">&lt;/keywords&gt;</span>
<span class="tag">&lt;/findItemsByKeywordsRequest&gt;</span></code></pre></div></div></section><section id="slide_level_1"><h2>Level 1</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-bd0cb.png" alt="rest integration bd0cb"></div></section><section id="slide_level_1_uris"><h2>Level 1 - URIs</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>POST /slots/1234/create HTTP/1.1 <i class="conum" data-value="1"></i><b>(1)</b></code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Akcja w URL</td></tr></table></div>
<div class="paragraph"><p>&#8203;</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;appointmentRequest&gt;</span>
  <span class="tag">&lt;patient</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">jsmith</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/appointmentRequest&gt;</span></code></pre></div></div></section><section id="slide_level_2"><h2>Level 2</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-e937d.png" alt="rest integration e937d"></div></section><section id="slide_level_2_http"><h2>Level 2 - HTTP</h2><div class="listingblock"><div class="title">Request</div><div class="content"><pre class="CodeRay"><code>GET /doctors/mjones/slots?date=20100104&amp;status=open HTTP/1.1
Host: royalhope.nhs.uk</code></pre></div></div>
<div class="listingblock"><div class="title">Response</div><div class="content"><pre class="CodeRay"><code>HTTP/1.1 200 OK <i class="conum" data-value="1"></i><b>(1)</b></code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Poprawne kody odpowiedzi HTTP</td></tr></table></div>
<div class="paragraph"><p>&#8203;</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;openSlotList&gt;</span>
  <span class="tag">&lt;slot</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1234” start = </span><span class="delimiter">&quot;</span></span><span class="attribute-name">1400</span><span class="error">&quot;</span> <span class="attribute-name">end</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1450</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;slot</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">5678” start = </span><span class="delimiter">&quot;</span></span><span class="attribute-name">1600</span><span class="error">&quot;</span> <span class="attribute-name">end</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1650</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/openSlotList&gt;</span></code></pre></div></div></section><section id="slide_level_2_metody_http"><h2>Level 2  - metody HTTP</h2><div class="ulist"><div class="title">GET (Safe and Idempotent)</div><ul><li><p><code>GET /auctions</code></p><div class="ulist"><ul><li><p>&#8594; <code>HTTP/1.1 200 OK</code></p></li></ul></div></li><li><p><code>GET /auctions/1234</code></p></li><li><p><code>GET /auctions?search=Macbook+Air</code></p></li></ul></div>
<div class="ulist"><div class="title">DELETE (<strong>Not</strong> safe and Idempotent)</div><ul><li><p><code>DELETE /auctions/1234</code></p><div class="ulist"><ul><li><p>&#8594; <code>HTTP/1.1 204 No Content</code></p></li></ul></div></li></ul></div></section><section id="slide_level_2_metody_http_2"><h2>Level 2 - metody HTTP</h2><div class="listingblock"><div class="title">Request</div><div class="content"><pre class="CodeRay"><code class="json language-json">{
 <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">Macbook Air 2010</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">condition</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">NEW</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span> : <span class="integer">499</span>
}</code></pre></div></div>
<div class="ulist"><div class="title">POST (<strong>Not</strong> safe and <strong>not</strong> Idempotent)</div><ul><li><p><code>POST /items</code></p><div class="ulist"><ul><li><p>&#8594; <code>HTTP/1.1 201 Created</code><br>
<code>Location: <a href="http://api.example.com/items/1235" class="bare">http://api.example.com/items/1235</a></code></p></li><li><p><strong>Serwer nadaje identyfikator</strong></p></li></ul></div></li></ul></div></section><section id="slide_level_2_metody_http_3"><h2>Level 2 - metody HTTP</h2><div class="listingblock"><div class="title">Request</div><div class="content"><pre class="CodeRay"><code class="json language-json">{
 <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">Macbook Air 2010</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">condition</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">LIKE_NEW</span><span class="delimiter">&quot;</span></span>,
 <span class="key"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span> : <span class="integer">498</span>
}</code></pre></div></div>
<div class="ulist"><div class="title">PUT (<strong>Not</strong> safe and Idempotent)</div><ul><li><p><code>PUT /items/1235</code></p></li><li><p><code>PUT /users/joe</code></p><div class="ulist"><ul><li><p>&#8594; <code>HTTP/1.1 204 No Content</code></p></li><li><p><strong>Klient przekazuje identyfikator</strong></p></li></ul></div></li></ul></div></section><section id="slide_level_2_metody_http_4"><h2>Level 2 - metody HTTP</h2><table class="tableblock frame-all grid-all" style=""><colgroup><col><col><col></colgroup><thead><tr><th class="tableblock halign-left valign-top">&#8203;</th><th class="tableblock halign-left valign-top"><code>/users</code></th><th class="tableblock halign-left valign-top"><code>/users/456</code></th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>GET</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Get All</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Get a user</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">New user</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>PUT</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Update</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><code>DELETE</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Delete All</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Delete a user</p></td></tr></tbody></table></section><section id="slide_level_2_http_responses"><h2>Level 2 - http responses</h2><div class="ulist"><ul><li><p><code>2xx</code>: here you go</p></li><li><p><code>3xx</code>: go away</p></li><li><p><code>4xx</code>: you fucked up</p></li><li><p><code>5xx</code>: I fucked up</p></li></ul></div></section><section id="slide_level_2_http_responses_2"><h2>Level 2 - http responses</h2><div class="dlist"><dl><dt class="hdlist1">Success</dt><dd><div class="ulist"><ul><li><p>200 OK</p></li><li><p>201 CREATED</p></li><li><p>202 ACCEPTED</p></li><li><p>204 NO CONTENT</p></li></ul></div></dd><dt class="hdlist1">Redirect</dt><dd><div class="ulist"><ul><li><p>301 MOVED PERMANENTLY</p></li><li><p>303 SEE OTHER</p></li><li><p>304 NOT MODIFIED</p></li><li><p>307 TEMPORARY REDIRECT</p></li></ul></div></dd></dl></div></section><section id="slide_level_2_http_responses_3"><h2>Level 2 - http responses</h2><div class="dlist"><dl><dt class="hdlist1">User error</dt><dd><div class="ulist"><ul><li><p>400 BAD REQUEST</p></li><li><p>401 UNAUTHORIZED</p></li><li><p>403 FORBIDDEN</p></li><li><p>404 NOT FOUND</p></li><li><p>405 METHOD NOT ALLOWED</p></li><li><p>410 GONE</p></li></ul></div></dd><dt class="hdlist1">Server error</dt><dd><div class="ulist"><ul><li><p>500 INTERNAL SERVER ERROR</p></li><li><p>503 SERVICE UNAVAILABLE</p></li></ul></div></dd></dl></div></section><section id="slide_level_2_http_responses_4"><h2>Level 2 - http responses</h2><div class="paragraph center"><p><strong>Kody błędu są dla błędów</strong></p></div>
<div class="listingblock"><div class="title">Request</div><div class="content"><pre class="CodeRay"><code>http://api.flickr.com/services/rest?
  method=flickr.photos.people.add
  &amp;api_key=xxx&amp;photo_id=yyy&amp;user_id=zzz</code></pre></div></div>
<div class="listingblock"><div class="title">Response</div><div class="content"><pre class="CodeRay"><code>HTTP/200 OK</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="tag">&lt;rsp</span> <span class="attribute-name">stat</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fail</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;err</span> <span class="attribute-name">code</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">100</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">msg</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Invalid API Key (Key has invalid format)</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/rsp&gt;</span></code></pre></div></div></section><section id="slide_level_2_2"><h2>Level 2</h2><div class="ulist"><div class="title">Kiedy jest to wystarczające?</div><ul><li><p>Małe API</p></li><li><p>CRUD</p></li><li><p>Brak wyraźnego <em>flow</em> (procesu) w obrębie aplikacji</p></li></ul></div></section><section id="slide_level_3"><h2>Level 3</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-62a4c.png" alt="rest integration 62a4c"></div></section><section id="slide_level_3_2"><h2>Level 3</h2><div class="imageblock white-background" style=""><img src="images/rest-integration-37e21.png" alt="rest integration 37e21"></div></section><section id="slide_level_3_3"><h2>Level 3</h2><div class="ulist"><div class="title">Zalety</div><ul><li><p>Sterowanie przepływem danych w aplikacji</p></li><li><p>Sterowanie dostępnymi podzasobami</p></li><li><p>Luźniejsze związanie serwera i klienta</p></li><li><p>Dodatkowa dokumentacja API (jednak niewystarczająca)</p></li></ul></div>
<div class="ulist"><div class="title">Wady</div><ul><li><p>Więcej pracy</p></li><li><p>Więcej transferu</p></li><li><p>Tworzenie API dla nieistniejącego klienta</p></li><li><p>Brak wyraźnego standardu (JSON API)</p></li></ul></div></section><section id="slide_level_3_response"><h2>Level 3 - response</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="xml language-xml"><span class="tag">&lt;appointment&gt;</span>
  <span class="tag">&lt;slot</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1234</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doctor</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">mjones</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">start</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1400</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">end</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1450</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;patient</span> <span class="attribute-name">id</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">jsmith</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;link</span> <span class="attribute-name">rel</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">/linkrels/appointment/addTest</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">uri</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">/slots/1234/appointment/tests</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;link</span> <span class="attribute-name">rel</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">/linkrels/appointment/updateContactInfo</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">uri</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">/patients/jsmith/contactInfo</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/appointment&gt;</span></code></pre></div></div></section><section id="slide_level_3_response_2"><h2>Level 3 - response</h2><div class="listingblock"><div class="title">Hypertext Application Language</div><div class="content"><pre class="CodeRay"><code>{
    "name": "Luke Skywalker",
    "height": "1.72 m",
    "mass": "77 Kg",
    "hair_color": "Blond",
    "_links": {
        "self": {
            "href": "http://swapi.co/api/people/1/",
            "title": "Luke Skywalker"
        },
        "http://swapi.co/api/rels/species": {
            "href": "http://swapi.co/api/species/1/",
            "title": "Human"
        }
    }
}</code></pre></div></div></section><section id="slide_wersjonowanie"><h2>Wersjonowanie </h2><div class="paragraph"><p>Czy URL jest elementem kontraktu? Czy bookmarkujemy, zapisujemy adresy URL?</p></div>
<div class="quoteblock"><blockquote>A REST API should be entered with no prior knowledge beyond the initial URI (bookmark) and set of standardized media types that are appropriate for the intended audience. Failure here implies that <strong>out-of-band information is driving interaction instead of hypertext</strong>.</blockquote><div class="attribution"><cite>REST APIs must be hypertext-driven (2008)</cite><br>&#8212; Roy T. Fielding</div></div></section><section id="slide_wersjonowanie_2"><h2>Wersjonowanie (2)</h2><div class="paragraph"><p>Czy informacja o MediaType jest konieczna aby skonsumować usługę?</p></div>
<div class="quoteblock"><blockquote>A REST API should spend almost all of its descriptive effort in defining the media type(s) used for representing resources and driving application state, or in defining extended relation names and/or hypertext-enabled mark-up for existing standard media types.</blockquote><div class="attribution"><cite>REST APIs must be hypertext-driven (2008)</cite><br>&#8212; Roy T. Fielding</div></div></section><section id="slide_wersjonowanie_5_levels_of_media_types"><h2>Wersjonowanie - 5 levels of media types</h2><div class="imageblock" style=""><img src="images/media+type+level+example.png" alt="media+type+level+example"></div>
<div class="ulist"><ul><li><p>formatting: <code>application/xml</code></p></li><li><p>schema: <code>application/rss+xml</code></p></li><li><p>domain: <code>application/vnd.google-earth.kml+xml</code></p></li><li><p>vesioning: <code>application/vnd.mycompany.billing-v2.1+json</code></p></li></ul></div></section><section id="slide_wersjonowanie_3"><h2>Wersjonowanie </h2><div class="listingblock"><div class="title">Media-type, bezpośrednio poprzez nazwę</div><div class="content"><pre class="CodeRay"><code>Request:
GET /opengov/garbageschedule?location=Main%20Street HTTP/1.1
Accept: application/vnd.opengov.org.garbageschedule-v2+json <i class="conum" data-value="1"></i><b>(1)</b>

Response:
HTTP/1.1 200 OK
Content-Type: application/vnd.opengov.org.garbageschedule-v2+json
  {
    "schedule"
    "self": "schedule-2423",
    "dayOfWeek": "Monday",
    "oddOrEvenWeeks": "Odd"
  }</code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Najbardziej RESTful z RESTful; wiele różnych media-type do ślednienia</td></tr></table></div></section><section id="slide_wersjonowanie_2_2"><h2>Wersjonowanie (2)</h2><div class="listingblock"><div class="title">Media-type, poprzez <em>qualifier</em></div><div class="content"><pre class="CodeRay"><code>Request:
GET /opengov/garbageschedule?location=Main%20Street HTTP/1.1
Accept: application/vnd.opengov.org.garbageschedule+json;v=1 <i class="conum" data-value="1"></i><b>(1)</b>

Response:
HTTP/1.1 200 OK
Content-Type: application/vnd.opengov.org.garbageschedule+json;v=1
  {
    "schedule"
    "self": "schedule-2423",
    "dayOfWeek": "Monday",
    "oddOrEvenWeeks": "Odd"
  }</code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td><em>Qualifier</em> wydaje się być łatwiejszy do implementacji.<br>
<em>Parameters MAY follow the type/subtype in the form of attribute/value pairs (rfc2616 sec 3.7)</em></td></tr></table></div></section><section id="slide_wersjonowanie_3_2"><h2>Wersjonowanie (3)</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="java language-java"><span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.example.user.v1+json;q=0.9</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> UserResponse findUserV1(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">userId</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> userId) {
    User user = userRepository.findOne(userId);
    <span class="keyword">return</span> userResponseFactory.successUserResponseV1(
        getMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">findById.success</span><span class="delimiter">&quot;</span></span>), user);
}

<span class="annotation">@Produces</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.example.user.v2+json</span><span class="delimiter">&quot;</span></span>})
<span class="directive">public</span> UserResponse findUserV2(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">userId</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> userId) {
    User user = userRepository.findOne(userId);
    <span class="keyword">return</span> userResponseFactory.successUserResponseV2(
        getMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">findById.success</span><span class="delimiter">&quot;</span></span>), user);
}</code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Parametr <code>q</code> obniża wartość parametru<br>
<em>HTTP content negotiation (section 12) uses short "floating point" numbers to indicate the relative importance ("weight") of various negotiable parameters (rfc2616 sec 3.9)</em></td></tr></table></div></section><section id="slide_wersjonowanie_4"><h2>Wersjonowanie (4)</h2><div class="listingblock"><div class="title">Wersja dodawana jest do URLa (domeny)</div><div class="content"><pre class="CodeRay"><code>Request:
GET /opengov/v1/garbageschedule?location=Main%20Street HTTP/1.1 <i class="conum" data-value="1"></i><b>(1)</b>
GET /opengov/garbageschedule?version=1&amp;location=Main%20Street HTTP/1.1 <i class="conum" data-value="2"></i><b>(2)</b>
Accept: application/vnd.opengov.org.garbageschedule+json

Response:
HTTP/1.1 200 OK
Content-Type: application/vnd.opengov.org.garbageschedule+json
  {
    "schedule"
    "self": "schedule-2423",
    "dayOfWeek": "Monday",
    "oddOrEvenWeeks": "Odd"
  }</code></pre></div></div></section><section id="slide_wersjonowanie_5"><h2>Wersjonowanie (5)</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>GET /opengov/v1/garbageschedule?location=Main%20Street HTTP/1.1</code></pre></div></div>
<div class="dlist"><dl><dt class="hdlist1">Wersja w URL</dt><dd><div class="ulist"><ul><li><p><strong>+</strong> Łatwe do testowania</p></li><li><p><strong>-</strong> Ten sam zasób funkcjonuje pod wieloma adresami URL. Dodatkowe elementy URL które nie mają znaczenia patrząc z punktu widzenia zasad REST</p></li><li><p><strong>-</strong> Wersja najbardziej aktualnego API nie jest jednoznaczna i bywa ciężka do odnalezienia (np. CKAN)</p></li></ul></div></dd></dl></div></section><section id="slide_wersjonowanie_6"><h2>Wersjonowanie (6)</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>GET /opengov/garbageschedule?version=1&amp;location=Main%20Street HTTP/1.1</code></pre></div></div>
<div class="dlist"><dl><dt class="hdlist1">Wersja w parametrach URL</dt><dd><div class="ulist"><ul><li><p><strong>+</strong> Łatwe do testowania</p></li><li><p><strong>+</strong> Domyślna wersja (aktualna) - np. poprzez brak podania wersji</p></li><li><p><strong>-</strong> Parametr <code>version</code> nie jest jednoznaczny i może być w konflikcie z atrybutami samego zasobu. Pomieszanie <em>query parameters</em> i <em>control parameters</em></p></li></ul></div></dd></dl></div></section><section id="slide_wersjonowanie_a_infrastruktura"><h2>Wersjonowanie a infrastruktura</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>map $http_accept $api_backend {
  default "localhost:8081";
  "~application/vnd\.example-v1\+json" "localhost:8080"
  "~application/vnd\.example-v2\+json" "localhost:8081"
}

proxy_pass http://$api_backend/$request_uri</code></pre></div></div>
<div class="ulist"><ul><li><p>Nie jest prawdą że konfiguracja na load balancerze jest możliwa tylko poprzez URL</p></li><li><p>Nginx pozwala na przekierowywanie wiadomości do odpowiedniego hosta w zależności od np. nagłówka <code>Accept</code></p></li></ul></div></section><section id="slide_ze_urle"><h2>Złe URLe</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>• http://www.acme.com/product/
• http://www.acme.com/product/filter/cats/desc
• http://www.acme.com/product/1234
• http://www.acme.com/photos/product/1234
• http://www.acme.com/photos/product/1234/new <i class="conum" data-value="1"></i><b>(1)</b>
• http://www.acme.com/photos/product/1234/5678 <i class="conum" data-value="2"></i><b>(2)</b></code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td><code>new</code> what?</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>PhotoID? ProductID?</td></tr></table></div></section><section id="slide_dobre_urle"><h2>Dobre URLe</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>• http://www.acme.com/products/  <i class="conum" data-value="1"></i><b>(1)</b>
• http://www.acme.com/products/?filter=cats&amp;sort=desc <i class="conum" data-value="2"></i><b>(2)</b>
• http://www.acme.com/products/1234 <i class="conum" data-value="3"></i><b>(3)</b>
• http://www.acme.com/products/1234/photos/ <i class="conum" data-value="4"></i><b>(4)</b>
• http://www.acme.com/products/1234/photos/?sort=latest
• http://www.acme.com/products/1234/photos/5678</code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Lista produktów</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>Filtrowania</td></tr><tr><td><i class="conum" data-value="3"></i><b>3</b></td><td>Pojedynczy produkt</td></tr><tr><td><i class="conum" data-value="4"></i><b>4</b></td><td>Wszystkie zdjęcie</td></tr></table></div></section><section id="slide_przykad_z_ycia_twitter_api"><h2>Przykład z życia - Twitter API </h2><div class="ulist"><div class="title">Status Show</div><ul><li><p>GET <code><a href="http://api.twitter.com/1/statuses/show/12345.json" class="bare">http://api.twitter.com/1/statuses/show/12345.json</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Akcja <em>show</em> jest elementem URLa</p></li></ul></div></li><li><p>Lepiej: GET <code><a href="http://twitter.com/statuses/12345" class="bare">http://twitter.com/statuses/12345</a></code> z odpowiednim <strong>Accept</strong> header</p></li></ul></div></section><section id="slide_przykad_z_ycia_twitter_api_2"><h2>Przykład z życia - Twitter API (2)</h2><div class="ulist"><div class="title">Status Update</div><ul><li><p>POST <code><a href="http://api.twitter.com/1/statuses/update.json" class="bare">http://api.twitter.com/1/statuses/update.json</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Akcja <em>update</em> jest elementem URLa</p></li><li><p>Użytkownik jest <em>implicite</em> jako wynik uwierzytelnienia</p></li></ul></div></li><li><p>Lepiej: POST <code><a href="http://twitter.com/users/fabpot/statuses/" class="bare">http://twitter.com/users/fabpot/statuses/</a></code></p></li></ul></div></section><section id="slide_przykad_z_ycia_twitter_api_3"><h2>Przykład z życia - Twitter API (3)</h2><div class="ulist"><div class="title">Status destroy</div><ul><li><p>POST <code><a href="http://api.twitter.com/1/statuses/destroy/12345.json" class="bare">http://api.twitter.com/1/statuses/destroy/12345.json</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Akcja <em>destroy</em> jest elementem URLa</p></li><li><p>Dziwna hierarchia, do czego odnosi się ID 12345?</p></li><li><p>Umożliwia zarówno akcję POST jak i DELETE</p></li></ul></div></li><li><p>Lepiej: DELETE <code><a href="http://twitter.com/statuses/12345" class="bare">http://twitter.com/statuses/12345</a></code></p></li></ul></div></section><section id="slide_przykad_z_ycia_twitter_api_4"><h2>Przykład z życia - Twitter API (4)</h2><div class="ulist"><div class="title">Status retweets</div><ul><li><p>GET <code><a href="http://api.twitter.com/1/statuses/retweets/12345.json" class="bare">http://api.twitter.com/1/statuses/retweets/12345.json</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Znowu dziwne hierarchia</p></li></ul></div></li><li><p>Lepiej: GET <code><a href="http://twitter.com/statuses/12345/retweets/" class="bare">http://twitter.com/statuses/12345/retweets/</a></code></p></li></ul></div></section><section id="slide_przykad_z_ycia_twitter_api_5"><h2>Przykład z życia - Twitter API (5)</h2><div class="ulist"><div class="title">Retweet</div><ul><li><p>PUT <code><a href="http://api.twitter.com/1/statuses/retweet/12345.format" class="bare">http://api.twitter.com/1/statuses/retweet/12345.format</a></code></p></li><li><p>Problemy:</p><div class="ulist"><ul><li><p>Akcja <em>retweet</em> jest elementem URLa</p></li><li><p>Umożliwia zarówno akcję POST jak i PUT</p></li></ul></div></li><li><p>Lepiej: POST <code><a href="http://twitter.com/statuses/12345/retweets/" class="bare">http://twitter.com/statuses/12345/retweets/</a></code></p></li></ul></div></section></section>
<section><section id="slide_wzorce_architektury_mikrousugowej" data-background-image="images/background.jpg" data-background-size="cover"><h2>Wzorce architektury mikrousługowej</h2></section><section><div class="sidebarblock"><div class="content"><div class="paragraph"><p>Patterns: <a href="../slides-patterns/slides.html" class="bare">../slides-patterns/slides.html</a></p></div></div></div></section></section>
<section><section id="slide_refaktoryzacja" data-background-image="images/background.jpg" data-background-size="cover"><h2>Refaktoryzacja</h2></section><section id="slide_stan_istniejcy_architektura"><h2>Stan istniejący (architektura)</h2><div class="ulist"><ul><li><p>3-tiered application</p><div class="ulist"><ul><li><p>Warstwa interfejsu użytkownika (GWT, JSF, Silverflight, Flash)</p></li><li><p>Warstwa uslug (komponentów biznesowych &#8594; logika aplikacji + <code>ManagedBean JSF</code>, SOAP WebServices)</p></li><li><p>Warstwa persystencji (baza danych)</p></li><li><p>Warstwa componentów integracyjnych (wejściowych i wyjściowych) (opcjonalnie)</p></li></ul></div></li></ul></div></section><section id="slide_stan_istniejcy_problemy"><h2>Stan istniejący (problemy)</h2><div class="ulist"><ul><li><p>Powiązania (sprzężenia) pomiędzy elementami aplikacji (obszarami funkcjonalnymi) - skutkujące niemożliwym do utrzymanie kodem</p></li><li><p>Zależności pomiędzy elementami w kodzie skutkujące sprzężeniami w <em>runtime</em> - żądania blokują i czekają</p></li><li><p>Problemy ze skalowaniem systemu: im więcej system <em>ma pracy</em>, tym dłużej trwają zapytania, tym dużej blokowane są wątki</p></li><li><p>Blokowanie bazy danych że względu na operowanie w zakresie pojedynczej transakcji.</p></li></ul></div></section><section id="slide_nim_zaczniemy_refaktoryzacj"><h2>Nim zaczniemy refaktoryzację</h2><div class="paragraph"><p>Implementacja monitoringu na samym początku okazuje się być kluczowa, aby śledzić czy poszczególne serwisy podlegając zmianą nadal <em>robią to co mają robić</em></p></div>
<div class="dlist"><dl><dt class="hdlist1">Implementacja monitoringu to dodatkowo</dt><dd><div class="ulist"><ul><li><p><strong>Analiza użycia</strong>: weryfikacja które elementy systemu używane są najintensywniej (dodatkowo, które są zmieniane - <em>churn</em> / <em>Feather&#8217;s Quadrant</em>) - możliwe że warto zacząć od tych elementów systemu</p></li><li><p><strong>Analiza wydajności</strong>: które elementy systemu są wąskimi gardłami, które są zasobożerne - możliwe że to są potencjalni kandydaci do refaktoryzacji</p></li></ul></div></dd></dl></div>
<div class="sidebarblock"><div class="content"><div class="paragraph"><p>Każdy system na zawsze tylko jedno ograniczenie</p></div></div></div></section><section id="slide_podejcie_od_strony_kodu"><h2>Podejście od strony kodu</h2></section><section id="slide_migracja_kodu"><h2>Migracja kodu</h2><div class="olist arabic"><ol class="arabic"><li><p>REST / JMS - pozostają bez zmian</p><div class="ulist"><ul><li><p>REST jako zasoby dla aplikacji frontendowej</p></li></ul></div></li><li><p>SOAP i EJB</p><div class="ulist"><ul><li><p>Implementacja wzorca <code>Service Facade</code> jest prosta do przełożenia na serwis <em>asset-based</em> (zmiana CRUDowych metod RPC na operacje na pojedynczych obiektach)</p></li><li><p>Pewna doza kompatybilności JAXB i JSON może być pomocna</p></li></ul></div></li><li><p>Servlet / JSP / JSF</p><div class="ulist"><ul><li><p>Konwersja 'logiki' zawartej w serwletach, <em>managed bean</em> w kierunku obiektów domenowych DDD.</p></li></ul></div></li></ol></div></section><section id="slide_migracja_nowe_funkcjonalnoci"><h2>Migracja / nowe funkcjonalności</h2><div class="imageblock" style=""><img src="https://cdn.wp.nginx.com/wp-content/uploads/2016/03/Adding_a_secure_microservice_alongside_a_monolithic_application.png" alt="Adding a secure microservice alongside a monolithic application" width="55%"></div></section><section id="slide_jak_zrobi_em_glue_code_em"><h2>Jak zrobić <em>glue code</em></h2><div class="ulist"><ul><li><p>Wywołanie zdalnych API dostarczonych przez <em>legacy application</em></p></li><li><p>Bezpośrednie połączenie do istniejących danych</p></li><li><p>Przetrzymywanie i synchronizowanie własnej kopi danych</p><div class="ulist"><ul><li><p>Eventual consistency / Event based integration</p></li></ul></div></li></ul></div></section><section id="slide_wyodrbnienie_istniejcego_kodu"><div class="imageblock" style=""><img src="images/Richardson-microservices-part7-extract-module_1.png" alt="Richardson microservices part7 extract module 1"></div></section><section id="slide_wyodrbnienie_istniejcego_kodu_2"><div class="imageblock" style=""><img src="images/Richardson-microservices-part7-extract-module_2.png" alt="Richardson microservices part7 extract module 2"></div></section><section id="slide_gdy_http_to_za_mao"><h2>Gdy HTTP to za mało</h2><div class="imageblock" style=""><img src="http://www.planetgeek.ch/wp-content/uploads/2012/09/Slide18.jpg" alt="Slide18"></div></section><section id="slide_podejcie_od_strony_domeny"><h2>Podejście od strony domeny</h2></section><section id="slide_jak_przeprowadzi_migracj_1"><h2>Jak przeprowadzić migrację (1)</h2><div class="paragraph"><p>Wraz z ekspertami domenowymi identyfikujemy kluczowe zdarzenia w obrębie systemu ("utworzenie klienta", "modyfikacja klienta", "rozpoczęcie procesu płatności", "zakończenie procesu płatności").</p></div>
<div class="paragraph"><p>Aplikacja rozpoczyna rozgłaszanie wiadomości (zdarzeń), a wraz z każdą aktualizacją systemu dodajemy więcej zdarzeń - nawet jeżeli nie są obsługiwane przez pozostałe elementy systemu</p></div></section><section id="slide_jak_przeprowadzi_migracj_2"><h2>Jak przeprowadzić migrację (2)</h2><div class="paragraph"><p>Nowe funkcjonalności (potencjalnie na <em>obrzeżach</em> systemu) mogą zacząć używać opublikowanych zdarzeń jako wyzwalaczy (<em>triggerów</em>).</p></div>
<div class="paragraph"><p>Przykładowo: funkcjonalności eksportu, przeliczenia w tle wymagane np. do raportów, tworzenie nowy elementów (wydarzeń) to listy zadań, de-duplikacja danych na potrzeby wydajności.</p></div>
<div class="paragraph"><p>Dzięki temu nowe moduły (funkcjonalności) mogą pojawiać się w systemie minimalizując konieczność ingerencji w istniejący kod.</p></div></section><section id="slide_jak_przeprowadzi_migracj_3"><h2>Jak przeprowadzić migrację (3)</h2><div class="paragraph"><p>Wyzwaniem może być pozostawienie spójnego interfejsu użytkownika. Pomimo rozbicia systemu na niezależne elementy, oczekiwane jest że interfejs użytkownika pozostanie spójny.</p></div>
<div class="paragraph"><p>Możliwe podejścia to:</p></div>
<div class="ulist"><ul><li><p>Single Page Application (SPA) - monolit na poziomie warstwy UI</p></li><li><p>Komponenty UI (np. dyrektywy AngularJS, komponenty ReactJS) - przywiązanie do konkretnej technologii</p></li><li><p>Niezależne komponenty - każdy mikroserwis samodzielnie publikuje fragment UI (snippet)</p><div class="ulist"><ul><li><p>Zalando Project Mosaic (<a href="https://www.mosaic9.org/" class="bare">https://www.mosaic9.org/</a>)</p></li><li><p>Allegro OpBox</p></li></ul></div></li></ul></div></section><section id="slide_jak_przeprowadzi_migracj_4"><h2>Jak przeprowadzić migrację (4)</h2><div class="imageblock" style=""><img src="https://bulldogjob.pl/ckeditor_assets/pictures/16/content_3.jpg" alt="content 3" width="90%"></div></section><section id="slide_podejcie_od_strony_danych"><h2>Podejście od strony danych</h2></section><section id="slide_migracja_danych"><h2>Migracja danych</h2><div class="olist arabic"><div class="title">Flavours of data</div><ol class="arabic"><li><p>Serializowane / binarne obiekty w kolumnach <code>Blob</code></p><div class="ulist"><ul><li><p>&#8594; Key-value store</p></li></ul></div></li><li><p>Płaskie struktury obiektów bez relacji (zdenormalizowane)</p><div class="ulist"><ul><li><p>&#8594; Dokumentowe struktury danych</p></li></ul></div></li><li><p>Słowniki (dane referencyjne) przetrzymywane w pamięci (<em>in-memory cache</em>)</p><div class="ulist"><ul><li><p>&#8594; Key-value store</p></li></ul></div></li><li><p>Skomplikowane zapytanie (wielopoziomowe, wielokrotne złączenia)</p><div class="ulist"><ul><li><p>&#8594; Może struktura danych jest drzewiasta / grafowa (Neo4j)</p></li></ul></div></li><li><p>Nasz model relacyjny jest OK</p></li></ol></div></section><section id="slide_migracja_struktur_relacyjnych"><h2>Migracja struktur relacyjnych</h2><div class="olist arabic"><ol class="arabic"><li><p>Zero Downtime migrations</p></li><li><p>Back and Forward compatibility</p></li><li><p>Baby steps (Small batch sizes)</p></li><li><p>Avoid locks</p></li></ol></div></section><section><div class="listingblock"><div class="title">Kiedyś</div><div class="content"><pre class="CodeRay"><code>ALTER TABLE customers RENAME COLUMN wrong TO correct;</code></pre></div></div>
<div class="listingblock"><div class="title">Teraz</div><div class="content"><pre class="CodeRay"><code>ALTER TABLE customers ADD COLUMN correct VARCHAR(20);
UPDATE customers SET correct = wrong WHERE id &lt; 100;
UPDATE customers SET correct = wrong WHERE id &lt; 200;
&lt;code update&gt;
&lt;code update&gt;
&lt;code update&gt;
(later...)ALTER TABLE customers DELETE COLUMN wrong</code></pre></div></div></section><section id="slide_zmiana_nazwy_kolumny_typu_danych"><h2>Zmiana nazwy kolumny / typu danych</h2><div class="olist arabic"><ol class="arabic"><li><p>Tworzenie nowej kolumny</p></li><li><p>Kod czyta ze starej kolumny, zapisuje do obu</p></li><li><p>Kopiujemy dane mały kawałkami</p></li><li><p>Kod czyta z nowej kolumny, zapisuje do obu</p></li><li><p>Kod czyta i zapisuje do nowej kolumny</p></li><li><p>Usuwamy starą kolumnę</p></li></ol></div></section><section id="slide_wyodrbnienie_danych"><h2>Wyodrębnienie danych</h2><div class="dlist"><dl><dt class="hdlist1">Widok</dt><dd><div class="ulist"><ul><li><p>Najłatwiejszy i najpopularniejszy</p></li><li><p>Spójność kosztem problemów z wydajnością</p></li><li><p>Bazy muszą być dla siebie widoczne</p></li></ul></div></dd><dt class="hdlist1">Widok zmaterializowany</dt><dd><p> </p></dd><dt class="hdlist1">Klonowanie tabel poprzez triggery</dt><dd><div class="ulist"><ul><li><p>Różny wsparcie w zależności o silnika bazy danych</p></li></ul></div></dd></dl></div></section><section id="slide_wyodrbnienie_danych_2"><h2>Wyodrębnienie danych</h2><div class="dlist"><dl><dt class="hdlist1">Klonowanie tabel poprzez zewnętrzne procesy ETL</dt><dd><div class="ulist"><ul><li><p>Wiele różnych narzędzi</p></li><li><p>Wymaga zewnętrznego <em>schedulera</em></p></li><li><p>Może operować na kilku bazach danych jednocześnie</p></li></ul></div></dd><dt class="hdlist1">Event sourcing</dt><dd><div class="ulist"><ul><li><p>Konwersja operacji bazodanowych na zdarzenia</p></li><li><p>Łatwa analiza danych</p></li><li><p>Brak silnej spójności danych</p></li></ul></div></dd></dl></div></section></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: false,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: false,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: false,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'black',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'fade',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1280,
  height: 720,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js/plugin/menu/menu.js' }
  ]
});</script></body></html>